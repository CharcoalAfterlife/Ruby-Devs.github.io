<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Ruby Devs - Gallery" />
    <meta property="og:description" content="See our created Extensions!" />
    <title>Ruby Devs - Extension List</title>
    <link rel="stylesheet" href="style.css">
    <style>
      .clickable {
        cursor: pointer;
      }

      /* Add fade-in animation */
      section {
        opacity: 0;
        transition: opacity 0.2s ease-in-out;
      }

      section.fade-in {
        opacity: 1;
      }
    </style>
</head>
<body>
  <header>
    <a href="/"><img src="logo.webp" alt="Ruby Devs Logo" height="80" id="logo"></a>
    <div id="headertxt">
      <h1>Ruby Devs</h1>
      <p>We make PenguinMod and TurboWarp cooler.</p>
    </div>
  </header>
    <div id="extension-list"></div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Fetch extensions.json
      fetch('https://rubyteam.tech/data/extensions.json')
        .then(response => response.json())
        .then(data => {
          // Generate list items dynamically
          const extensionList = document.getElementById('extension-list');
          const div = document.createElement('div');
          const br = document.createElement('br');

          data.forEach(extension => {
            const section = document.createElement('section');
            
            // Add style to center the thumbnail
            section.style.textAlign = 'center';

            const thumb = document.createElement('img');
            thumb.src = extension.thumb;
            thumb.height = "330";

            // Create h1 and p elements for the section
            const h2 = document.createElement('h2');
            h2.innerHTML = extension.name;

            const p = document.createElement('p');
            p.innerHTML = extension.description;

            // Append h1 and p to the section
            section.appendChild(thumb);
            section.appendChild(h2);
            section.appendChild(p);
            section.appendChild(br);

            const button = document.createElement('button');
            button.innerHTML = "Try " + extension.name;
            button.classList.add('clickable');

            const howto = document.createElement('a');
            howto.innerHTML = " <button>How to import extensions</button>";
            howto.href = "import_tut.html";

            // Add click event to redirect to the URL
            button.addEventListener('click', function () {
              // URL of the JavaScript file
              const url = extension.url;

              // Fetch the contents of the JavaScript file
              fetch(url)
                .then(response => response.text()) // assuming the file is text-based
                .then(data => {
                  // Create a Blob from the fetched data
                  const blob = new Blob([data], { type: 'application/javascript' });

                  // Create a link element
                  const link = document.createElement('a');

                  // Set the href attribute of the link to the Blob URL
                  link.href = URL.createObjectURL(blob);

                  // Set the download attribute with the desired file name
                  link.download = extension.name + ".js";

                  // Append the link to the document
                  document.body.appendChild(link);

                  // Trigger a click on the link to start the download
                  link.click();

                  // Remove the link from the document
                  document.body.removeChild(link);
                })
                .catch(error => {
                  console.error('Error fetching and downloading the file:', error);
                });
            });

            // Append the buttons to the section
            section.appendChild(button);
            section.appendChild(howto);

            // Add the fade-in class after a delay for each section
            setTimeout(() => {
              section.classList.add('fade-in');
            }, 1000 + 200 * data.indexOf(extension));
          });

          // Append the div to the extensionList
          extensionList.appendChild(div);
        })
        .catch(error => console.error('Error fetching extensions.json:', error));
    });
  </script>

</body>
</html>
